{"ast":null,"code":"import { useClickAway } from 'ahooks';\nimport classNames from 'classnames';\nimport React, { cloneElement, useEffect, useRef, useState, forwardRef, useImperativeHandle, isValidElement } from 'react';\nimport Popup from '../popup';\nimport { ItemChildrenWrap } from './item';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { defaultPopupBaseProps } from '../popup/popup-base-props';\nconst classPrefix = `adm-dropdown`;\nconst defaultProps = {\n  defaultActiveKey: null,\n  closeOnMaskClick: true,\n  closeOnClickAway: false,\n  getContainer: defaultPopupBaseProps['getContainer']\n};\nconst Dropdown = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue({\n    value: props.activeKey,\n    defaultValue: props.defaultActiveKey,\n    onChange: props.onChange\n  });\n  const navRef = useRef(null);\n  const contentRef = useRef(null);\n  // 点击外部区域，关闭\n  useClickAway(() => {\n    if (!props.closeOnClickAway) return;\n    setValue(null);\n  }, [navRef, contentRef]);\n  // 计算 navs 的 top 值\n  const [top, setTop] = useState();\n  const containerRef = useRef(null);\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n    if (value) {\n      const rect = container.getBoundingClientRect();\n      setTop(rect.bottom);\n    }\n  }, [value]);\n  const changeActive = key => {\n    if (value === key) {\n      setValue(null);\n    } else {\n      setValue(key);\n    }\n  };\n  let popupForceRender = false;\n  const items = [];\n  const navs = React.Children.map(props.children, child => {\n    if (isValidElement(child)) {\n      const childProps = Object.assign(Object.assign({}, child.props), {\n        onClick: event => {\n          var _a, _b;\n          changeActive(child.key);\n          (_b = (_a = child.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n        },\n        active: child.key === value,\n        arrow: child.props.arrow === undefined ? props.arrow : child.props.arrow\n      });\n      items.push(child);\n      if (child.props.forceRender) popupForceRender = true;\n      return cloneElement(child, childProps);\n    } else {\n      return child;\n    }\n  });\n  useImperativeHandle(ref, () => ({\n    close: () => {\n      setValue(null);\n    }\n  }), [setValue]);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-open`]: !!value\n    }),\n    ref: containerRef\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-nav`,\n    ref: navRef\n  }, navs), React.createElement(Popup, {\n    visible: !!value,\n    position: 'top',\n    getContainer: props.getContainer,\n    className: `${classPrefix}-popup`,\n    maskClassName: `${classPrefix}-popup-mask`,\n    bodyClassName: `${classPrefix}-popup-body`,\n    style: {\n      top\n    },\n    forceRender: popupForceRender,\n    onMaskClick: props.closeOnMaskClick ? () => {\n      changeActive(null);\n    } : undefined\n  }, React.createElement(\"div\", {\n    ref: contentRef\n  }, items.map(item => {\n    const isActive = item.key === value;\n    return React.createElement(ItemChildrenWrap, {\n      key: item.key,\n      active: isActive,\n      forceRender: item.props.forceRender,\n      destroyOnClose: item.props.destroyOnClose\n    }, item.props.children);\n  })))));\n});\nexport default Dropdown;","map":{"version":3,"names":["useClickAway","classNames","React","cloneElement","useEffect","useRef","useState","forwardRef","useImperativeHandle","isValidElement","Popup","ItemChildrenWrap","withNativeProps","mergeProps","usePropsValue","defaultPopupBaseProps","classPrefix","defaultProps","defaultActiveKey","closeOnMaskClick","closeOnClickAway","getContainer","Dropdown","p","ref","props","value","setValue","activeKey","defaultValue","onChange","navRef","contentRef","top","setTop","containerRef","container","current","rect","getBoundingClientRect","bottom","changeActive","key","popupForceRender","items","navs","Children","map","children","child","childProps","Object","assign","onClick","event","_a","_b","call","active","arrow","undefined","push","forceRender","close","createElement","className","visible","position","maskClassName","bodyClassName","style","onMaskClick","item","isActive","destroyOnClose"],"sources":["C:/Users/86150/Desktop/GreenHouses_app/node_modules/antd-mobile/es/components/dropdown/dropdown.js"],"sourcesContent":["import { useClickAway } from 'ahooks';\nimport classNames from 'classnames';\nimport React, { cloneElement, useEffect, useRef, useState, forwardRef, useImperativeHandle, isValidElement } from 'react';\nimport Popup from '../popup';\nimport { ItemChildrenWrap } from './item';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { defaultPopupBaseProps } from '../popup/popup-base-props';\nconst classPrefix = `adm-dropdown`;\nconst defaultProps = {\n  defaultActiveKey: null,\n  closeOnMaskClick: true,\n  closeOnClickAway: false,\n  getContainer: defaultPopupBaseProps['getContainer']\n};\nconst Dropdown = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue({\n    value: props.activeKey,\n    defaultValue: props.defaultActiveKey,\n    onChange: props.onChange\n  });\n  const navRef = useRef(null);\n  const contentRef = useRef(null);\n  // 点击外部区域，关闭\n  useClickAway(() => {\n    if (!props.closeOnClickAway) return;\n    setValue(null);\n  }, [navRef, contentRef]);\n  // 计算 navs 的 top 值\n  const [top, setTop] = useState();\n  const containerRef = useRef(null);\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n    if (value) {\n      const rect = container.getBoundingClientRect();\n      setTop(rect.bottom);\n    }\n  }, [value]);\n  const changeActive = key => {\n    if (value === key) {\n      setValue(null);\n    } else {\n      setValue(key);\n    }\n  };\n  let popupForceRender = false;\n  const items = [];\n  const navs = React.Children.map(props.children, child => {\n    if (isValidElement(child)) {\n      const childProps = Object.assign(Object.assign({}, child.props), {\n        onClick: event => {\n          var _a, _b;\n          changeActive(child.key);\n          (_b = (_a = child.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n        },\n        active: child.key === value,\n        arrow: child.props.arrow === undefined ? props.arrow : child.props.arrow\n      });\n      items.push(child);\n      if (child.props.forceRender) popupForceRender = true;\n      return cloneElement(child, childProps);\n    } else {\n      return child;\n    }\n  });\n  useImperativeHandle(ref, () => ({\n    close: () => {\n      setValue(null);\n    }\n  }), [setValue]);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-open`]: !!value\n    }),\n    ref: containerRef\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-nav`,\n    ref: navRef\n  }, navs), React.createElement(Popup, {\n    visible: !!value,\n    position: 'top',\n    getContainer: props.getContainer,\n    className: `${classPrefix}-popup`,\n    maskClassName: `${classPrefix}-popup-mask`,\n    bodyClassName: `${classPrefix}-popup-body`,\n    style: {\n      top\n    },\n    forceRender: popupForceRender,\n    onMaskClick: props.closeOnMaskClick ? () => {\n      changeActive(null);\n    } : undefined\n  }, React.createElement(\"div\", {\n    ref: contentRef\n  }, items.map(item => {\n    const isActive = item.key === value;\n    return React.createElement(ItemChildrenWrap, {\n      key: item.key,\n      active: isActive,\n      forceRender: item.props.forceRender,\n      destroyOnClose: item.props.destroyOnClose\n    }, item.props.children);\n  })))));\n});\nexport default Dropdown;"],"mappings":"AAAA,SAASA,YAAY,QAAQ,QAAQ;AACrC,OAAOC,UAAU,MAAM,YAAY;AACnC,OAAOC,KAAK,IAAIC,YAAY,EAAEC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,UAAU,EAAEC,mBAAmB,EAAEC,cAAc,QAAQ,OAAO;AACzH,OAAOC,KAAK,MAAM,UAAU;AAC5B,SAASC,gBAAgB,QAAQ,QAAQ;AACzC,SAASC,eAAe,QAAQ,0BAA0B;AAC1D,SAASC,UAAU,QAAQ,gCAAgC;AAC3D,SAASC,aAAa,QAAQ,6BAA6B;AAC3D,SAASC,qBAAqB,QAAQ,2BAA2B;AACjE,MAAMC,WAAW,GAAI,cAAa;AAClC,MAAMC,YAAY,GAAG;EACnBC,gBAAgB,EAAE,IAAI;EACtBC,gBAAgB,EAAE,IAAI;EACtBC,gBAAgB,EAAE,KAAK;EACvBC,YAAY,EAAEN,qBAAqB,CAAC,cAAc;AACpD,CAAC;AACD,MAAMO,QAAQ,GAAGf,UAAU,CAAC,CAACgB,CAAC,EAAEC,GAAG,KAAK;EACtC,MAAMC,KAAK,GAAGZ,UAAU,CAACI,YAAY,EAAEM,CAAC,CAAC;EACzC,MAAM,CAACG,KAAK,EAAEC,QAAQ,CAAC,GAAGb,aAAa,CAAC;IACtCY,KAAK,EAAED,KAAK,CAACG,SAAS;IACtBC,YAAY,EAAEJ,KAAK,CAACP,gBAAgB;IACpCY,QAAQ,EAAEL,KAAK,CAACK;EAClB,CAAC,CAAC;EACF,MAAMC,MAAM,GAAG1B,MAAM,CAAC,IAAI,CAAC;EAC3B,MAAM2B,UAAU,GAAG3B,MAAM,CAAC,IAAI,CAAC;EAC/B;EACAL,YAAY,CAAC,MAAM;IACjB,IAAI,CAACyB,KAAK,CAACL,gBAAgB,EAAE;IAC7BO,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC,EAAE,CAACI,MAAM,EAAEC,UAAU,CAAC,CAAC;EACxB;EACA,MAAM,CAACC,GAAG,EAAEC,MAAM,CAAC,GAAG5B,QAAQ,CAAC,CAAC;EAChC,MAAM6B,YAAY,GAAG9B,MAAM,CAAC,IAAI,CAAC;EACjCD,SAAS,CAAC,MAAM;IACd,MAAMgC,SAAS,GAAGD,YAAY,CAACE,OAAO;IACtC,IAAI,CAACD,SAAS,EAAE;IAChB,IAAIV,KAAK,EAAE;MACT,MAAMY,IAAI,GAAGF,SAAS,CAACG,qBAAqB,CAAC,CAAC;MAC9CL,MAAM,CAACI,IAAI,CAACE,MAAM,CAAC;IACrB;EACF,CAAC,EAAE,CAACd,KAAK,CAAC,CAAC;EACX,MAAMe,YAAY,GAAGC,GAAG,IAAI;IAC1B,IAAIhB,KAAK,KAAKgB,GAAG,EAAE;MACjBf,QAAQ,CAAC,IAAI,CAAC;IAChB,CAAC,MAAM;MACLA,QAAQ,CAACe,GAAG,CAAC;IACf;EACF,CAAC;EACD,IAAIC,gBAAgB,GAAG,KAAK;EAC5B,MAAMC,KAAK,GAAG,EAAE;EAChB,MAAMC,IAAI,GAAG3C,KAAK,CAAC4C,QAAQ,CAACC,GAAG,CAACtB,KAAK,CAACuB,QAAQ,EAAEC,KAAK,IAAI;IACvD,IAAIxC,cAAc,CAACwC,KAAK,CAAC,EAAE;MACzB,MAAMC,UAAU,GAAGC,MAAM,CAACC,MAAM,CAACD,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEH,KAAK,CAACxB,KAAK,CAAC,EAAE;QAC/D4B,OAAO,EAAEC,KAAK,IAAI;UAChB,IAAIC,EAAE,EAAEC,EAAE;UACVf,YAAY,CAACQ,KAAK,CAACP,GAAG,CAAC;UACvB,CAACc,EAAE,GAAG,CAACD,EAAE,GAAGN,KAAK,CAACxB,KAAK,EAAE4B,OAAO,MAAM,IAAI,IAAIG,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACC,IAAI,CAACF,EAAE,EAAED,KAAK,CAAC;QAC3F,CAAC;QACDI,MAAM,EAAET,KAAK,CAACP,GAAG,KAAKhB,KAAK;QAC3BiC,KAAK,EAAEV,KAAK,CAACxB,KAAK,CAACkC,KAAK,KAAKC,SAAS,GAAGnC,KAAK,CAACkC,KAAK,GAAGV,KAAK,CAACxB,KAAK,CAACkC;MACrE,CAAC,CAAC;MACFf,KAAK,CAACiB,IAAI,CAACZ,KAAK,CAAC;MACjB,IAAIA,KAAK,CAACxB,KAAK,CAACqC,WAAW,EAAEnB,gBAAgB,GAAG,IAAI;MACpD,OAAOxC,YAAY,CAAC8C,KAAK,EAAEC,UAAU,CAAC;IACxC,CAAC,MAAM;MACL,OAAOD,KAAK;IACd;EACF,CAAC,CAAC;EACFzC,mBAAmB,CAACgB,GAAG,EAAE,OAAO;IAC9BuC,KAAK,EAAEA,CAAA,KAAM;MACXpC,QAAQ,CAAC,IAAI,CAAC;IAChB;EACF,CAAC,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EACf,OAAOf,eAAe,CAACa,KAAK,EAAEvB,KAAK,CAAC8D,aAAa,CAAC,KAAK,EAAE;IACvDC,SAAS,EAAEhE,UAAU,CAACe,WAAW,EAAE;MACjC,CAAE,GAAEA,WAAY,OAAM,GAAG,CAAC,CAACU;IAC7B,CAAC,CAAC;IACFF,GAAG,EAAEW;EACP,CAAC,EAAEjC,KAAK,CAAC8D,aAAa,CAAC,KAAK,EAAE;IAC5BC,SAAS,EAAG,GAAEjD,WAAY,MAAK;IAC/BQ,GAAG,EAAEO;EACP,CAAC,EAAEc,IAAI,CAAC,EAAE3C,KAAK,CAAC8D,aAAa,CAACtD,KAAK,EAAE;IACnCwD,OAAO,EAAE,CAAC,CAACxC,KAAK;IAChByC,QAAQ,EAAE,KAAK;IACf9C,YAAY,EAAEI,KAAK,CAACJ,YAAY;IAChC4C,SAAS,EAAG,GAAEjD,WAAY,QAAO;IACjCoD,aAAa,EAAG,GAAEpD,WAAY,aAAY;IAC1CqD,aAAa,EAAG,GAAErD,WAAY,aAAY;IAC1CsD,KAAK,EAAE;MACLrC;IACF,CAAC;IACD6B,WAAW,EAAEnB,gBAAgB;IAC7B4B,WAAW,EAAE9C,KAAK,CAACN,gBAAgB,GAAG,MAAM;MAC1CsB,YAAY,CAAC,IAAI,CAAC;IACpB,CAAC,GAAGmB;EACN,CAAC,EAAE1D,KAAK,CAAC8D,aAAa,CAAC,KAAK,EAAE;IAC5BxC,GAAG,EAAEQ;EACP,CAAC,EAAEY,KAAK,CAACG,GAAG,CAACyB,IAAI,IAAI;IACnB,MAAMC,QAAQ,GAAGD,IAAI,CAAC9B,GAAG,KAAKhB,KAAK;IACnC,OAAOxB,KAAK,CAAC8D,aAAa,CAACrD,gBAAgB,EAAE;MAC3C+B,GAAG,EAAE8B,IAAI,CAAC9B,GAAG;MACbgB,MAAM,EAAEe,QAAQ;MAChBX,WAAW,EAAEU,IAAI,CAAC/C,KAAK,CAACqC,WAAW;MACnCY,cAAc,EAAEF,IAAI,CAAC/C,KAAK,CAACiD;IAC7B,CAAC,EAAEF,IAAI,CAAC/C,KAAK,CAACuB,QAAQ,CAAC;EACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACR,CAAC,CAAC;AACF,eAAe1B,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}